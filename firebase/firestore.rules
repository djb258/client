rules_version = '2';
service cloud.firestore {
  match /databases/{database}/documents {

    // All collections in clnt_subhive
    match /clnt_subhive/{collection}/{docId} {
      allow read, write: if request.auth != null;

      // Validation: must include blueprint_id & process_id
      allow create: if request.resource.data.blueprint_id is string
                    && request.resource.data.process_id is string;
    }
  }
}